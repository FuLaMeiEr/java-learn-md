# spring 事务


### spring事务的特性
1. 原子性：事务是原子操作，对事物的操作要么全部成功，要么全部失败
2. 一致性：事务执行前后的数据的完整性保持一致
3. 隔离性：一个事务的执行过程中,不应该受其他事务的干扰
4. 持久性：事务一旦结束，数据就持久到数据库


### 事务的隔离级别
1. 脏读：一个事务读取了另一个修改了但未提交的数据
2. 不可重复读：一个事务在执行相同的两次以上，每次的查询的结果都不同。这通常是由于另一个并发事务在两次查询之间更新了数据。
3. 幻读： 一个事务读取到另一个事务修改已提交的数据，导致查询结果不一样。

设置事务隔离级别 
1. DEFAULT这是一个PlatfromTransactionManager默认的隔离级别，使用数据库默认的事务隔离级别；
2. 读未提交: 脏读，不可重复读，幻读都可能出现；
3. 读已提交：可避免脏读
4. 可重复读：可避免脏读，不可重复读
5. 串行化：可避免脏读，不可重复读，幻读

- mysql默认： 可重复读
- oracle默认：读已提交

### 事务的传播行为
PROPAGATION_XXX：事务的传播行为
- 保证在同一事务中
 1. PROPAGATION_REQUIRED 如果当前没有事务，就新建一个事务，如果已经存在一个事务中，则支持这个事务中。默认的传播机制。
 2. PROPAGATION_SUPPORTS 如果存在一个事务，则支持当前事务，如果没有事务，则进行非事务执行
 3. PROPAGATION_MANDATORY 如果存在一个事务，则支持当前事务，如果没有活动的事务，抛出异常
- 保证没有在同一事务中
 4. PROPAGATION_REQUIRES_NEW 总是开启一个新的事务，如果当前存在事务，这把当前事务挂起
 5. PROPAGATION_NOT_SUUORTED 总是非事务执行，并挂起任何存在事务
 6. PROPAGATION_NEVER 总是非事务的执行，如果存在一个活动事务，则抛出异常
 7. PROPAGATION_NESTED 如果一个活动事务的存在，则运行在另一个嵌套的事务中，如果没有活动事务,则按默认的传播机制执行



### spring事务的配置方式

